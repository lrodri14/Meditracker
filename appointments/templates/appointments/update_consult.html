{%extends 'base.html'%}
{%load static%}
{%block title%}Consult{%endblock%}
{%block body_block%}
<link rel="stylesheet" href="{%static 'appointments/css/update_consult.css'%}">
{%block return%}{%endblock%}{%block home%}{%endblock%}
<form method="POST" enctype="multipart/form-data">
    {%csrf_token%}
    {{medical_exams_form.management_form}}
    <div class="wrapper">
        <div class="general-info">
            <a href="{%url 'appointments:consults'%}"><i class="fas fa-long-arrow-alt-left"></i></a><a href="{%url 'appointments:consults_list' consult.patient.pk%}"><i class="fas fa-book-medical"></i></a>
            <h1 id="heading">Consult <i class="fas fa-file-medical-alt"></i></h1>
            <h4>Patient</h4>
            <p>{{consult.patient.first_names}} {{consult.patient.last_names}}</p>
            <h4>ID Number</h4>
            <p>{{consult.patient.id_number}}</p>
            <h4>Date & Time</h4>
            <p>{{consult.datetime|date}} - {{consult.datetime|time}}</p>
            <h4>Motive</h4>
            <p>{{consult.motive}}</p>
            <h4>Suffering</h4>
            <p>{{consult.suffering}}</p>
            <h4 id="charge-label">{{consult_form.charge.label}}</h4>
            <p>{{consult_form.charge}}</p>
            <button type="submit">Save</button>
            <p>{{error}}</p>
        </div>
        <div class="diagnose">
            <i class="fas fa-angle-left"></i><i class="fas fa-angle-right"></i>
            <div>
                <div class="data">
                    <h3>Vital Signs</h3>
                    <p>{{consult_form.blood_pressure.label}}</p>
                    <p>{{consult_form.blood_pressure}}</p>
                    <p>{{consult_form.temperature.label}}</p>
                    <p>{{consult_form.temperature}}</p>
                    <p>{{consult_form.weight.label}}</p>
                    <p>{{consult_form.weight}}</p>
                    <p>{{consult_form.size.label}}</p>
                    <p>{{consult_form.size}}</p>
                </div>
            </div>
            <div>
                <div class="data">
                    <h2>Examination</h2>
                    <h3>Organ System</h3>
                    <p>{{consult_form.digestive_system.label}} {{consult_form.digestive_system}}</p>
                    <p>{{consult_form.endocrine_system.label}} {{consult_form.endocrine_system}}</p>
                    <p>{{consult_form.renal_system.label}} {{consult_form.renal_system}}</p>
                    <p>{{consult_form.lymphatic_system.label}} {{consult_form.lymphatic_system}}</p>
                    <p>{{consult_form.respiratory_system.label}} {{consult_form.respiratory_system}}</p>
                    <h3>Physical Exploration</h3>
                    <p>{{consult_form.head_exploration.label}} {{consult_form.head_exploration}}</p>
                    <p>{{consult_form.thorax_exploration.label}} {{consult_form.thorax_exploration}}</p>
                    <p>{{consult_form.medical_exams}}</p>
                </div>
            </div>
            <div>
                <div class="data">
                    <h2>Diagnose</h2>
                    <p>{{consult_form.cie_10_group.label}} {{consult_form.cie_10_group}}</p>
                    <p>{{consult_form.cie_10_detail.label}} {{consult_form.cie_10_detail}}</p>
                    <p>{{consult_form.diagnose.label}} {{consult_form.diagnose}}</p>
                    <p>{{consult_form.procedure.label}} {{consult_form.procedure}}</p>
                    <p>{{consult_form.analysis.label}} {{consult_form.analysis}}</p>
                    <p>{{consult_form.notes.label}} {{consult_form.notes}}</p>
                </div>
            </div>
            <div class="data">
                <h2>Treatment</h2>
                <p>{{drug_form.category.label}}</p>
                <p data-url="{%url 'settings:drug_category'%}">{{drug_form.category}}</p>
                <p>{{consult_form.drugs.label}}<i class="fas fa-plus add-drug"></i></p>
                <div id="drugs">
                    <p>{{consult_form.drugs}}</p>
                </div>
                <p>{{consult_form.medicine.label}} {{consult_form.medicine}}</p><br>
                <p>{{consult_form.actions.label}} {{consult_form.actions}}</p>
            </div>
            <ul class="navigation">
            </ul>
        </div>
    </div>
</form>

<div class="exams-modal">
    <div class="exams-data">
        <h2>Exams <i class="far fa-eye" id="show-preview"></i></h2>
        <div class="exams-list">
            <table class="exams-table">
                <thead>
                    <th>Type</th>
                    <th>File</th>
                    <th>Filename</th>
                    <th><i class="fas fa-plus add-form"></i></th>
                </thead>
                <tbody>
                    {%for form in medical_exams_form%}
                        <tr class="form-container">
                            <td>{{form.type}}</td>
                            <td>{{form.image}}<label class="add-exam" for="id_form-{{forloop.counter0}}-image">Add Image</label></td>
                            <td class="filename"></td>
                            <td><i class="fas fa-trash"></i></td>
                            <td class="delete-form">{{form.DELETE}}</td>
                        </tr>
                    {%endfor%}
                </tbody>
            </table>
        </div>
        <button type="button" id="save">Save</button>
    </div>
</div>

<div class="preview-image">
    <img class="previewed-image" src="" alt="">
</div>

<div class="add-drug-modal">
    <div class="add-drug-modal-content">
        <form method="POST" action="{%url 'settings:drug_add'%}" autocomplete="off" class="add-drug-form">
            {%csrf_token%}
            <h1>Add Drug</h1>
            <p>{{drug_form.name.label}}</p>
            <p>{{drug_form.name}}</p>
            <p>{{drug_form.category.label}}</p>
            <p>{{drug_form.category}}</p>
            <p id="error"></p>
            <p><button type="submit" id="drug-submit">Add Drug</button></p>
        </form>
    </div>
</div>

<script src="{%static 'appointments/js/update_consult.js'%}"></script>
{%endblock%}